(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{408:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r=function(e){var t=new FileReader;return new Promise((function(i,r){try{t.readAsDataURL(e),t.onloadend=function(){i(t.result)}}catch(e){throw new Error("Ошибка при чтении файла")}}))}},412:function(e,t,i){},413:function(e,t,i){},414:function(e,t,i){},424:function(e,t,i){"use strict";var r=i(412);i.n(r).a},425:function(e,t,i){"use strict";var r=i(413);i.n(r).a},426:function(e,t,i){"use strict";var r=i(414);i.n(r).a},429:function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("section",{staticClass:"reviews"},[i("div",{staticClass:"container container_admin"},[e._m(0),i("div",{staticClass:"reviews__content reviews__content_edit-review"},[e.isVisibleEditForm?i("editReview",{attrs:{editMode:e.editMode},on:{hideEditForm:e.hideEditForm}}):e._e()],1),i("div",{staticClass:"reviews__content reviews__content_added-reviews"},[i("div",{staticClass:"added-reviews"},[i("ul",{staticClass:"added-reviews__list"},[i("li",{staticClass:"added-reviews__item"},[i("div",{staticClass:"add add_theme_big",on:{click:function(t){return e.showEditForm("new")}}},[i("span",{staticClass:"add__text add__text_bottom_offset"},[e._v("Добавить отзыв")]),i("button",{staticClass:"add__plus add__plus_top_offset",attrs:{type:"button"}})])]),e._l(e.reviews,(function(t){return i("li",{key:t.id,staticClass:"added-reviews__item"},[i("review",{attrs:{reviewObject:t},on:{showEditForm:e.showEditForm}})],1)}))],2)])])])])};r._withStripped=!0;var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"edit-review"},[i("div",{staticClass:"edit-review__title"},[e._v(e._s(e.title))]),i("div",{staticClass:"edit-review__content"},[i("form",{staticClass:"edit-review__form",on:{submit:function(t){return t.preventDefault(),e.handleReviewForm(t)}}},[i("div",{staticClass:"edit-review__image"},[e.editMode&&e.$v.renderedPhoto.$invalid?i("div",{staticClass:"edit-review__error edit-review__error_photo"},[i("span",[e._v("Прикрепите фото автора отзыва")])]):e._e(),i("label",{staticClass:"edit-review__image-load-label",attrs:{for:"review-image"}},[i("span",{staticClass:"edit-review__image-text"},[e._v(e._s(e.textLoadPhoto))]),i("vue-dropzone",{ref:"myVueDropzone",attrs:{id:"dropzone-review",options:e.dropzoneOptions}}),i("input",{staticClass:"edit-review__image-load",attrs:{id:"review-image",type:"file"},on:{change:e.changeFileReviewImg}})],1),i("div",{staticClass:"edit-review__image-place",style:{backgroundImage:"url("+e.renderedPhoto+")"}})]),i("div",{staticClass:"edit-review__info"},[i("div",{staticClass:"edit-review__row"},[i("div",{staticClass:"edit-review__group edit-review__group_name"},[i("label",{staticClass:"edit-review__label"},[e._v("Имя автора")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.review.author,expression:"review.author"}],staticClass:"edit-review__input",domProps:{value:e.review.author},on:{input:function(t){t.target.composing||e.$set(e.review,"author",t.target.value)}}}),e.editMode&&e.$v.review.author.$invalid?i("div",{staticClass:"edit-review__error edit-review__error_name"},[e.$v.review.author.maxLength?e.$v.review.author.minLength?i("span",[e._v("Обязательно для заполнения")]):i("span",[e._v("Минимум символов: "+e._s(e.$v.review.author.$params.minLength.min))]):i("span",[e._v("Максимум символов: "+e._s(e.$v.review.author.$params.maxLength.max))])]):e._e()]),i("div",{staticClass:"edit-review__group edit-review__group_occupation"},[i("label",{staticClass:"edit-review__label"},[e._v("Титул автора")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.review.occ,expression:"review.occ"}],staticClass:"edit-review__input",domProps:{value:e.review.occ},on:{input:function(t){t.target.composing||e.$set(e.review,"occ",t.target.value)}}}),e.editMode&&e.$v.review.occ.$invalid?i("div",{staticClass:"edit-review__error edit-review__error_occupation"},[e.$v.review.occ.maxLength?e.$v.review.occ.minLength?i("span",[e._v("Обязательно для заполнения")]):i("span",[e._v("Минимум символов: "+e._s(e.$v.review.occ.$params.minLength.min))]):i("span",[e._v("Максимум символов: "+e._s(e.$v.review.occ.$params.maxLength.max))])]):e._e()])]),i("div",{staticClass:"edit-review__row edit-review__row_textarea"},[i("div",{staticClass:"edit-review__group edit-review__group_review"},[i("label",{staticClass:"edit-review__label"},[e._v("Отзыв")]),i("textarea",{directives:[{name:"model",rawName:"v-model",value:e.review.text,expression:"review.text"}],staticClass:"edit-review__input edit-review__input_textarea",attrs:{type:"textarea",rows:"3",resize:"none"},domProps:{value:e.review.text},on:{input:function(t){t.target.composing||e.$set(e.review,"text",t.target.value)}}}),e.editMode&&e.$v.review.text.$invalid?i("div",{staticClass:"edit-review__error edit-review__error_review"},[e.$v.review.text.maxLength?e.$v.review.text.minLength?i("span",[e._v("Обязательно для заполнения")]):i("span",[e._v("Минимум символов: "+e._s(e.$v.review.text.$params.minLength.min))]):i("span",[e._v("Максимум символов: "+e._s(e.$v.review.text.$params.maxLength.max))])]):e._e()])]),i("div",{staticClass:"edit-review__row edit-review__row_buttons"},[i("button",{staticClass:"edit-review__cancel",on:{click:function(t){return e.$emit("hideEditForm")}}},[e._v("Отмена")]),i("button",{staticClass:"edit-review__submit",attrs:{type:"submit"}},[e._v("Сохранить")])])])])])])};n._withStripped=!0;var s=i(24),o=i(408),a=i(67),c=i(380),v=i(415),d=i.n(v);i(416);function u(e,t,i,r,n,s,o){try{var a=e[s](o),c=a.value}catch(e){return void i(e)}a.done?t(c):Promise.resolve(c).then(r,n)}function l(e){return function(){var t=this,i=arguments;return new Promise((function(r,n){var s=e.apply(t,i);function o(e){u(s,r,n,o,a,"next",e)}function a(e){u(s,r,n,o,a,"throw",e)}o(void 0)}))}}function w(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function _(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?w(Object(i),!0).forEach((function(t){p(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):w(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function p(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var h=s.a.defaults.baseURL,m={components:{vueDropzone:d.a},props:{editMode:String},data:function(){return{title:"Новый отзыв",textLoadPhoto:"Добавить фото",renderedPhoto:"",review:{photo:"",author:"",occ:"",text:""},dropzoneOptions:{url:"https://httpbin.org/post",maxFilesize:1.5,maxFiles:1,chunking:!1,addRemoveLinks:!1}}},computed:_({},Object(a.d)("reviews",{currentReview:function(e){return e.currentReview}})),validations:{review:{author:{required:c.required,minLength:Object(c.minLength)(2),maxLength:Object(c.maxLength)(30)},occ:{required:c.required,minLength:Object(c.minLength)(2),maxLength:Object(c.maxLength)(30)},text:{required:c.required,minLength:Object(c.minLength)(10),maxLength:Object(c.maxLength)(200)}},renderedPhoto:{required:c.required}},watch:{currentReview:function(){"edit"===this.editMode?this.setChangedReview():"new"===this.editMode&&this.clearReview()}},created:function(){"edit"===this.editMode&&this.setChangedReview()},methods:_({clearReview:function(){this.review={photo:"",author:"",occ:"",text:""},this.textLoadPhoto="Добавить фото",this.title="Новый отзыв",this.renderedPhoto=""},setChangedReview:function(){this.review=_({},this.currentReview),this.renderedPhoto="".concat(h,"/").concat(this.review.photo),this.review.photo="",this.textLoadPhoto="Изменить фото",this.title="Редактирование отзыва"},changeFileReviewImg:function(e){var t=this;this.review.photo=e.target.files[0],Object(o.a)(this.review.photo).then((function(e){t.renderedPhoto=e})),this.textLoadPhoto="Изменить фото"}},Object(a.b)("reviews",["addReview","changeReview"]),{handleReviewForm:function(){if(this.$v.$invalid)console.log("INVALID FORM");else{var e=new FormData;e.append("photo",this.review.photo),e.append("author",this.review.author),e.append("occ",this.review.occ),e.append("text",this.review.text),"new"===this.editMode?this.addNewReview(e):"edit"===this.editMode&&this.editReview(e,this.review.id),this.$emit("hideEditForm")}},addNewReview:function(e){var t=this;return l(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,t.addReview(e);case 3:i.next=8;break;case 5:i.prev=5,i.t0=i.catch(0),alert("исправь потом меня, я ошибка из addNewReview: "+i.t0.message);case 8:return i.prev=8,i.finish(8);case 10:case"end":return i.stop()}}),i,null,[[0,5,8,10]])})))()},editReview:function(e,t){var i=this;return l(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,i.changeReview({renewReviewData:e,changedReviewId:t});case 3:r.next=8;break;case 5:r.prev=5,r.t0=r.catch(0),alert("исправь потом меня, я ошибка из editReview: "+r.t0.message);case 8:return r.prev=8,r.finish(8);case 10:case"end":return r.stop()}}),r,null,[[0,5,8,10]])})))()}})},f=(i(424),i(47)),b=Object(f.a)(m,n,[],!1,null,null,null);b.options.__file="src/admin/components/app-edit-review.vue";var g=b.exports,O=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"review"},[i("div",{staticClass:"review__topgroup"},[i("div",{staticClass:"review__avatar"},[i("img",{staticClass:"review__image-author",attrs:{src:e.baseUrl+"/"+e.reviewObject.photo}})]),i("div",{staticClass:"review__author"},[e._v(e._s(e.reviewObject.author)),i("div",{staticClass:"review__occupation"},[e._v(e._s(e.reviewObject.occ))])])]),i("div",{staticClass:"review__info"},[i("div",{staticClass:"review__text"},[e._v(e._s(e.reviewObject.text))])]),i("div",{staticClass:"review__controls"},[i("div",{staticClass:"controls controls_with_text"},[i("span",{staticClass:"controls__text"},[e._v("Править                          ")]),i("button",{staticClass:"controls__btn controls__btn_blue_edit",on:{click:e.editReview}})]),i("div",{staticClass:"controls controls_with_text"},[i("span",{staticClass:"controls__text"},[e._v("Удалить                          ")]),i("button",{staticClass:"controls__btn controls__btn_red_remove",on:{click:e.removeReview}})])])])};function x(e,t,i,r,n,s,o){try{var a=e[s](o),c=a.value}catch(e){return void i(e)}a.done?t(c):Promise.resolve(c).then(r,n)}function C(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function j(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?C(Object(i),!0).forEach((function(t){R(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):C(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function R(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}O._withStripped=!0;var y=s.a.defaults.baseURL,P={props:{reviewObject:Object},data:function(){return{changedReview:j({},this.reviewObject),baseUrl:y}},methods:j({},Object(a.b)("reviews",["deleteReview","setCurrentReview"]),{editReview:function(){this.setCurrentReview(this.changedReview.id),this.$emit("showEditForm","edit")},removeReview:function(){var e,t=this;return(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.deleteReview(t.reviewObject.id);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),alert("исправь потом меня, я ошибка из removeReview: "+e.t0.message);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})),function(){var t=this,i=arguments;return new Promise((function(r,n){var s=e.apply(t,i);function o(e){x(s,r,n,o,a,"next",e)}function a(e){x(s,r,n,o,a,"throw",e)}o(void 0)}))})()}})},$=(i(425),Object(f.a)(P,O,[],!1,null,null,null));function L(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function E(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?L(Object(i),!0).forEach((function(t){F(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):L(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function F(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}$.options.__file="src/admin/components/app-review.vue";var k={components:{editReview:g,review:$.exports},data:function(){return{isVisibleEditForm:!1,editMode:""}},computed:E({},Object(a.d)("reviews",{allReviews:function(e){return e.reviews}}),{reviews:function(){return this.allReviews.sort((function(e,t){return t.id-e.id}))}}),created:function(){this.refreshAllReviews()},methods:E({},Object(a.b)("reviews",["refreshAllReviews","setCurrentReview"]),{showEditForm:function(e){this.isVisibleEditForm=!0,this.editMode=e,"new"===e&&this.setCurrentReview()},hideEditForm:function(){this.isVisibleEditForm=!1}})},D=(i(426),Object(f.a)(k,r,[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"reviews__topgroup reviews__topgroup_reviews"},[t("h3",{staticClass:"reviews__title"},[this._v('Блок "Отзывы"   ')])])}],!1,null,null,null));D.options.__file="src/admin/components/app-section-reviews.vue";t.default=D.exports}}]);
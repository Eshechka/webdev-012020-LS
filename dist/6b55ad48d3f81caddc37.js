(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{410:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var o=function(t){var e=new FileReader;return new Promise((function(r,o){try{e.readAsDataURL(t),e.onloadend=function(){r(e.result)}}catch(t){throw new Error("Ошибка при чтении файла")}}))}},411:function(t,e,r){},412:function(t,e,r){},413:function(t,e,r){},423:function(t,e,r){"use strict";var o=r(411);r.n(o).a},424:function(t,e,r){"use strict";var o=r(412);r.n(o).a},425:function(t,e,r){"use strict";var o=r(413);r.n(o).a},430:function(t,e,r){"use strict";r.r(e);var o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",{staticClass:"works"},[r("div",{staticClass:"container container_admin"},[t._m(0),r("div",{staticClass:"works__content works__content_edit-work"},[t.isVisibleEditForm?r("editWork",{attrs:{editMode:t.editMode},on:{hideEditForm:t.hideEditForm}}):t._e()],1),r("div",{staticClass:"works__content works__content_added-works"},[r("div",{staticClass:"added-works"},[r("ul",{staticClass:"added-works__list"},[r("li",{staticClass:"added-works__item"},[r("div",{staticClass:"add add_theme_big",on:{click:function(e){return t.showEditForm("new")}}},[r("span",{staticClass:"add__text"},[t._v("Добавить работу")]),r("button",{staticClass:"add__plus",attrs:{type:"button"}})])]),t._l(t.works,(function(e){return r("li",{key:e.id,staticClass:"added-works__item"},[r("work",{attrs:{workObject:e},on:{showEditForm:t.showEditForm}})],1)}))],2)])])])])};o._withStripped=!0;var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"edit-work"},[r("div",{staticClass:"edit-work__title"},[t._v(t._s(t.title))]),r("div",{staticClass:"edit-work__content"},[r("form",{staticClass:"edit-work__form",on:{submit:function(e){return e.preventDefault(),t.handleWorkForm(e)}}},[r("div",{staticClass:"edit-work__image"},[r("div",{staticClass:"edit-work__image-wrapper",style:{backgroundImage:"url("+t.renderedPhoto+")"}},[r("span",{staticClass:"edit-work__image-text"},[t._v(t._s(t.textLoadPhoto))]),r("button",{staticClass:"edit-work__image-load"},[t._v("Загрузить")]),r("label",{staticClass:"edit-work__image-label",attrs:{for:"work-image"}},[r("vue-dropzone",{ref:"myVueDropzone",attrs:{id:"dropzone-work",options:t.dropzoneOptions}}),r("input",{staticClass:"edit-work__image-load-input",attrs:{type:"file"},on:{change:t.changeFileWorkImg}})],1)]),t.editMode&&t.$v.renderedPhoto.$invalid?r("div",{staticClass:"edit-work__error edit-work__error_photo"},[r("span",[t._v("Прикрепите фото работы")])]):t._e()]),r("div",{staticClass:"edit-work__info"},[r("div",{staticClass:"edit-work__row edit-work__row_name"},[r("label",{staticClass:"edit-work__label"},[t._v("Название")]),r("input",{directives:[{name:"model",rawName:"v-model",value:t.work.title,expression:"work.title"}],staticClass:"edit-work__input",domProps:{value:t.work.title},on:{input:function(e){e.target.composing||t.$set(t.work,"title",e.target.value)}}}),t.editMode&&t.$v.work.title.$invalid?r("div",{staticClass:"edit-work__error edit-work__error_name"},[t.$v.work.title.maxLength?t.$v.work.title.minLength?r("span",[t._v("Обязательно для заполнения")]):r("span",[t._v("Минимум символов: "+t._s(t.$v.work.title.$params.minLength.min))]):r("span",[t._v("Максимум символов: "+t._s(t.$v.work.title.$params.maxLength.max))])]):t._e()]),r("div",{staticClass:"edit-work__row edit-work__row_link"},[r("label",{staticClass:"edit-work__label"},[t._v("Ссылка")]),r("input",{directives:[{name:"model",rawName:"v-model",value:t.work.link,expression:"work.link"}],staticClass:"edit-work__input",domProps:{value:t.work.link},on:{input:function(e){e.target.composing||t.$set(t.work,"link",e.target.value)}}}),t.editMode&&t.$v.work.link.$invalid?r("div",{staticClass:"edit-work__error edit-work__error_link"},[t.$v.work.link.url?r("span",[t._v("Обязательно для заполнения")]):r("span",[t._v("Требуется url адрес")])]):t._e()]),r("div",{staticClass:"edit-work__row edit-work__row_desc"},[r("label",{staticClass:"edit-work__label"},[t._v("Описание")]),r("textarea",{directives:[{name:"model",rawName:"v-model",value:t.work.description,expression:"work.description"}],staticClass:"edit-work__input",attrs:{type:"textarea",rows:"4",resize:"none"},domProps:{value:t.work.description},on:{input:function(e){e.target.composing||t.$set(t.work,"description",e.target.value)}}}),t.editMode&&t.$v.work.description.$invalid?r("div",{staticClass:"edit-work__error edit-work__error_text"},[t.$v.work.description.maxLength?t.$v.work.description.minLength?r("span",[t._v("Обязательно для заполнения                ")]):r("span",[t._v("Минимум символов: "+t._s(t.$v.work.description.$params.minLength.min))]):r("span",[t._v("Максимум символов: "+t._s(t.$v.work.description.$params.maxLength.max))])]):t._e()]),r("div",{staticClass:"edit-work__row edit-work__row_tags"},[r("label",{staticClass:"edit-work__label"},[t._v("Добавление тега")]),r("input",{directives:[{name:"model",rawName:"v-model",value:t.work.techs,expression:"work.techs"}],staticClass:"edit-work__input",domProps:{value:t.work.techs},on:{input:function(e){e.target.composing||t.$set(t.work,"techs",e.target.value)}}}),t.editMode&&t.$v.work.techs.$invalid?r("div",{staticClass:"edit-work__error edit-work__error_techs"},[r("span",[t._v("Обязательно для заполнения")])]):t._e(),r("div",{staticClass:"edit-work__added-tags"},t._l(t.tags,(function(e,o){return r("div",{staticClass:"edit-work__added-tag"},[t._v(t._s(e.replace(/[\s|,]+/g,"").trim())),r("div",{staticClass:"edit-work__added-tag-close",on:{click:function(e){return t.removeTag(o)}}})])})),0)]),r("div",{staticClass:"edit-work__row edit-work__row_buttons"},[r("button",{staticClass:"edit-work__cancel",on:{click:function(e){return t.$emit("hideEditForm")}}},[t._v("Отмена")]),r("button",{staticClass:"edit-work__submit",attrs:{type:"submit"}},[t._v("Сохранить")])])])])])])};i._withStripped=!0;var n=r(410),s=r(24),a=r(67),c=r(382),d=r(417),l=r.n(d);r(418);function u(t,e,r,o,i,n,s){try{var a=t[n](s),c=a.value}catch(t){return void r(t)}a.done?e(c):Promise.resolve(c).then(o,i)}function _(t){return function(){var e=this,r=arguments;return new Promise((function(o,i){var n=t.apply(e,r);function s(t){u(n,o,i,s,a,"next",t)}function a(t){u(n,o,i,s,a,"throw",t)}s(void 0)}))}}function k(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function w(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?k(Object(r),!0).forEach((function(e){p(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function p(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var h=s.a.defaults.baseURL,v={components:{vueDropzone:l.a},props:{editMode:String},data:function(){return{title:"Новая работа",textLoadPhoto:"Перетащите или нажмите для загрузки изображения",renderedPhoto:"",work:{title:"",photo:"",link:"",techs:"",description:""},dropzoneOptions:{url:"https://httpbin.org/post",maxFilesize:1.5,maxFiles:1,chunking:!1,addRemoveLinks:!1}}},computed:w({},Object(a.d)("works",{currentWork:function(t){return t.currentWork}}),{tags:function(){return this.work.techs.match(/[a-zа-яё0-9.-]+[\s|,]*/gi)}}),validations:{work:{title:{required:c.required,minLength:Object(c.minLength)(2),maxLength:Object(c.maxLength)(30)},link:{required:c.required,url:c.url},techs:{required:c.required},description:{required:c.required,minLength:Object(c.minLength)(10),maxLength:Object(c.maxLength)(1e3)}},renderedPhoto:{required:c.required}},watch:{currentWork:function(){"edit"===this.editMode?this.setChangedWork():"new"===this.editMode&&this.clearWork()}},created:function(){"edit"===this.editMode&&this.setChangedWork()},methods:w({clearWork:function(){this.work={title:"",photo:"",link:"",techs:"",description:""},this.textLoadPhoto="Перетащите или нажмите для загрузки изображения",this.title="Новая работа",this.renderedPhoto=""},setChangedWork:function(){this.work=w({},this.currentWork),this.renderedPhoto="".concat(h,"/").concat(this.work.photo),this.work.photo="",this.textLoadPhoto="Перетащите или нажмите, чтобы изменить фото работы",this.title="Редактирование работы"},changeFileWorkImg:function(t){var e=this;this.work.photo=t.target.files[0],Object(n.a)(this.work.photo).then((function(t){e.renderedPhoto=t})),this.textLoadPhoto="Перетащите или нажмите, чтобы изменить фото работы"},removeTag:function(t){this.tags.splice(t,1),this.work.techs=this.tags.join("")}},Object(a.b)("works",["addWork","changeWork"]),{handleWorkForm:function(){if(this.$v.$invalid)console.log("INVALID FORM");else{var t=new FormData;t.append("photo",this.work.photo),t.append("title",this.work.title),t.append("link",this.work.link),t.append("techs",this.work.techs),t.append("description",this.work.description),"new"===this.editMode?this.addNewWork(t):"edit"===this.editMode&&this.editWork(t,this.work.id),this.$emit("hideEditForm")}},addNewWork:function(t){var e=this;return _(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.addWork(t);case 3:r.next=8;break;case 5:r.prev=5,r.t0=r.catch(0),alert("исправь потом меня, я ошибка из addNewWork: "+r.t0.message);case 8:return r.prev=8,r.finish(8);case 10:case"end":return r.stop()}}),r,null,[[0,5,8,10]])})))()},editWork:function(t,e){var r=this;return _(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,r.changeWork({renewWorkData:t,changedWorkId:e});case 3:o.next=8;break;case 5:o.prev=5,o.t0=o.catch(0),alert("исправь потом меня, я ошибка из editWork: "+o.t0.message);case 8:return o.prev=8,o.finish(8);case 10:case"end":return o.stop()}}),o,null,[[0,5,8,10]])})))()}})},m=(r(423),r(47)),f=Object(m.a)(v,i,[],!1,null,null,null);f.options.__file="src/admin/components/app-edit-work.vue";var b=f.exports,g=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"work"},[r("div",{staticClass:"work__image"},[r("img",{staticClass:"work__picture",attrs:{src:t.baseUrl+"/"+t.workObject.photo}}),r("ul",{staticClass:"work__tags"},t._l(t.tags,(function(e){return r("li",{staticClass:"work__tag"},[t._v(t._s(e))])})),0)]),r("div",{staticClass:"work__info"},[r("div",{staticClass:"work__title"},[t._v(t._s(t.workObject.title))]),r("div",{staticClass:"work__text"},[t._v(t._s(t.workObject.description))]),r("a",{staticClass:"work__link"},[t._v(t._s(t.workObject.link))])]),r("div",{staticClass:"work__controls"},[r("div",{staticClass:"controls controls_with_text"},[r("span",{staticClass:"controls__text"},[t._v("Править                          ")]),r("button",{staticClass:"controls__btn controls__btn_blue_edit",on:{click:t.editWork}})]),r("div",{staticClass:"controls controls_with_text"},[r("span",{staticClass:"controls__text"},[t._v("Удалить                          ")]),r("button",{staticClass:"controls__btn controls__btn_red_remove",on:{click:t.removeWork}})])])])};function O(t,e,r,o,i,n,s){try{var a=t[n](s),c=a.value}catch(t){return void r(t)}a.done?e(c):Promise.resolve(c).then(o,i)}function C(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function j(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?C(Object(r),!0).forEach((function(e){y(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function y(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}g._withStripped=!0;var P=s.a.defaults.baseURL,x={props:{workObject:Object},data:function(){return{changedWork:j({},this.workObject),baseUrl:P}},computed:{tags:function(){return this.workObject.techs.split(/[\s|,]+/)}},methods:j({},Object(a.b)("works",["deleteWork","setCurrentWork"]),{editWork:function(){this.setCurrentWork(this.changedWork.id),this.$emit("showEditForm","edit")},removeWork:function(){var t,e=this;return(t=regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.deleteWork(e.workObject.id);case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),alert("исправь потом меня, я ошибка из removeWork: "+t.t0.message);case 8:case"end":return t.stop()}}),t,null,[[0,5]])})),function(){var e=this,r=arguments;return new Promise((function(o,i){var n=t.apply(e,r);function s(t){O(n,o,i,s,a,"next",t)}function a(t){O(n,o,i,s,a,"throw",t)}s(void 0)}))})()}})},W=(r(424),Object(m.a)(x,g,[],!1,null,null,null));function $(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function L(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?$(Object(r),!0).forEach((function(e){E(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function E(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}W.options.__file="src/admin/components/app-work.vue";var F={components:{editWork:b,work:W.exports},data:function(){return{isVisibleEditForm:!1,editMode:""}},computed:L({},Object(a.d)("works",{allWorks:function(t){return t.works}}),{works:function(){return this.allWorks.sort((function(t,e){return e.id-t.id}))}}),created:function(){this.refreshAllWorks()},methods:L({},Object(a.b)("works",["refreshAllWorks","setCurrentWork"]),{showEditForm:function(t){this.isVisibleEditForm=!0,this.editMode=t,"new"===t&&this.setCurrentWork()},hideEditForm:function(){this.isVisibleEditForm=!1}})},D=(r(425),Object(m.a)(F,o,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"works__topgroup"},[e("h3",{staticClass:"works__title"},[this._v('Блок "Работы" ')])])}],!1,null,null,null));D.options.__file="src/admin/components/app-section-works.vue";e.default=D.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{415:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var o=function(t){var e=new FileReader;return new Promise((function(r,o){try{e.readAsDataURL(t),e.onloadend=function(){r(e.result)}}catch(t){throw new Error("Ошибка при чтении файла")}}))}},416:function(t,e,r){},417:function(t,e,r){},418:function(t,e,r){},428:function(t,e,r){"use strict";var o=r(416);r.n(o).a},429:function(t,e,r){"use strict";var o=r(417);r.n(o).a},430:function(t,e,r){"use strict";var o=r(418);r.n(o).a},435:function(t,e,r){"use strict";r.r(e);var o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",{staticClass:"works"},[r("div",{staticClass:"container container_admin"},[t._m(0),r("div",{staticClass:"works__content works__content_edit-work"},[t.isVisibleEditForm?r("editWork",{attrs:{editMode:t.editMode},on:{hideEditForm:t.hideEditForm}}):t._e()],1),r("div",{staticClass:"works__content works__content_added-works"},[r("div",{staticClass:"added-works"},[r("ul",{staticClass:"added-works__list"},[r("li",{staticClass:"added-works__item"},[r("div",{staticClass:"add add_theme_big",on:{click:function(e){return t.showEditForm("new")}}},[r("span",{staticClass:"add__text"},[t._v("Добавить работу")]),r("button",{staticClass:"add__plus",attrs:{type:"button"}})])]),t._l(t.works,(function(e){return r("li",{key:e.id,staticClass:"added-works__item"},[r("work",{attrs:{workObject:e},on:{showEditForm:t.showEditForm}})],1)}))],2)])])])])};o._withStripped=!0;var i=r(67),s=r.n(i),n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"edit-work"},[r("div",{staticClass:"edit-work__title"},[t._v(t._s(t.title))]),r("div",{staticClass:"edit-work__content"},[r("form",{staticClass:"edit-work__form",on:{submit:function(e){return e.preventDefault(),t.handleWorkForm(e)}}},[r("div",{staticClass:"edit-work__image"},[r("div",{staticClass:"edit-work__image-wrapper",style:{backgroundImage:"url("+t.renderedPhoto+")"}},[r("span",{staticClass:"edit-work__image-text"},[t._v(t._s(t.textLoadPhoto))]),r("button",{staticClass:"edit-work__image-load"},[t._v("Загрузить")]),r("label",{staticClass:"edit-work__image-label",attrs:{for:"work-image"}},[r("vue-dropzone",{ref:"myVueDropzone",attrs:{id:"dropzone-work",options:t.dropzoneOptions}}),r("input",{staticClass:"edit-work__image-load-input",attrs:{type:"file"},on:{change:t.changeFileWorkImg}})],1)]),t.editMode&&t.$v.renderedPhoto.$invalid?r("div",{staticClass:"edit-work__error edit-work__error_photo"},[r("span",[t._v("Прикрепите фото работы")])]):t._e()]),r("div",{staticClass:"edit-work__info"},[r("div",{staticClass:"edit-work__row edit-work__row_name"},[r("label",{staticClass:"edit-work__label"},[t._v("Название")]),r("input",{directives:[{name:"model",rawName:"v-model",value:t.work.title,expression:"work.title"}],staticClass:"edit-work__input",domProps:{value:t.work.title},on:{input:function(e){e.target.composing||t.$set(t.work,"title",e.target.value)}}}),t.editMode&&t.$v.work.title.$invalid?r("div",{staticClass:"edit-work__error edit-work__error_name"},[t.$v.work.title.maxLength?t.$v.work.title.minLength?r("span",[t._v("Обязательно для заполнения")]):r("span",[t._v("Минимум символов: "+t._s(t.$v.work.title.$params.minLength.min))]):r("span",[t._v("Максимум символов: "+t._s(t.$v.work.title.$params.maxLength.max))])]):t._e()]),r("div",{staticClass:"edit-work__row edit-work__row_link"},[r("label",{staticClass:"edit-work__label"},[t._v("Ссылка")]),r("input",{directives:[{name:"model",rawName:"v-model",value:t.work.link,expression:"work.link"}],staticClass:"edit-work__input",domProps:{value:t.work.link},on:{input:function(e){e.target.composing||t.$set(t.work,"link",e.target.value)}}}),t.editMode&&t.$v.work.link.$invalid?r("div",{staticClass:"edit-work__error edit-work__error_link"},[t.$v.work.link.url?r("span",[t._v("Обязательно для заполнения")]):r("span",[t._v("Требуется url адрес")])]):t._e()]),r("div",{staticClass:"edit-work__row edit-work__row_desc"},[r("label",{staticClass:"edit-work__label"},[t._v("Описание")]),r("textarea",{directives:[{name:"model",rawName:"v-model",value:t.work.description,expression:"work.description"}],staticClass:"edit-work__input",attrs:{type:"textarea",rows:"4",resize:"none"},domProps:{value:t.work.description},on:{input:function(e){e.target.composing||t.$set(t.work,"description",e.target.value)}}}),t.editMode&&t.$v.work.description.$invalid?r("div",{staticClass:"edit-work__error edit-work__error_text"},[t.$v.work.description.maxLength?t.$v.work.description.minLength?r("span",[t._v("Обязательно для заполнения                ")]):r("span",[t._v("Минимум символов: "+t._s(t.$v.work.description.$params.minLength.min))]):r("span",[t._v("Максимум символов: "+t._s(t.$v.work.description.$params.maxLength.max))])]):t._e()]),r("div",{staticClass:"edit-work__row edit-work__row_tags"},[r("label",{staticClass:"edit-work__label"},[t._v("Добавление тега")]),r("input",{directives:[{name:"model",rawName:"v-model",value:t.work.techs,expression:"work.techs"}],staticClass:"edit-work__input",domProps:{value:t.work.techs},on:{input:function(e){e.target.composing||t.$set(t.work,"techs",e.target.value)}}}),t.editMode&&t.$v.work.techs.$invalid?r("div",{staticClass:"edit-work__error edit-work__error_techs"},[r("span",[t._v("Обязательно для заполнения")])]):t._e(),r("div",{staticClass:"edit-work__added-tags"},t._l(t.tags,(function(e,o){return r("div",{staticClass:"edit-work__added-tag"},[t._v(t._s(e.replace(/[\s|,]+/g,"").trim())),r("div",{staticClass:"edit-work__added-tag-close",on:{click:function(e){return t.removeTag(o)}}})])})),0)]),r("div",{staticClass:"edit-work__row edit-work__row_buttons"},[r("button",{staticClass:"edit-work__cancel",on:{click:function(e){return t.$emit("hideEditForm")}}},[t._v("Отмена")]),r("button",{staticClass:"edit-work__submit",attrs:{type:"submit"}},[t._v("Сохранить")])])])])])])};n._withStripped=!0;var a=r(5),c=r.n(a),d=r(11),l=r.n(d),_=r(415),u=r(26),k=r(70),w=r(387),p=r(422),h=r.n(p);r(423);function v(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function m(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?v(Object(r),!0).forEach((function(e){s()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var f=u.a.defaults.baseURL,b={components:{vueDropzone:h.a},props:{editMode:String},data:function(){return{title:"Новая работа",textLoadPhoto:"Перетащите или нажмите для загрузки изображения",renderedPhoto:"",work:{title:"",photo:"",link:"",techs:"",description:""},dropzoneOptions:{url:"https://httpbin.org/post",maxFilesize:1.5,maxFiles:1,chunking:!1,addRemoveLinks:!1}}},computed:m({},Object(k.d)("works",{currentWork:function(t){return t.currentWork}}),{tags:function(){return this.work.techs.match(/[a-zа-яё0-9.-]+[\s|,]*/gi)}}),validations:{work:{title:{required:w.required,minLength:Object(w.minLength)(2),maxLength:Object(w.maxLength)(30)},link:{required:w.required,url:w.url},techs:{required:w.required},description:{required:w.required,minLength:Object(w.minLength)(10),maxLength:Object(w.maxLength)(1e3)}},renderedPhoto:{required:w.required}},watch:{currentWork:function(){"edit"===this.editMode?this.setChangedWork():"new"===this.editMode&&this.clearWork()}},created:function(){"edit"===this.editMode&&this.setChangedWork()},methods:m({clearWork:function(){this.work={title:"",photo:"",link:"",techs:"",description:""},this.textLoadPhoto="Перетащите или нажмите для загрузки изображения",this.title="Новая работа",this.renderedPhoto=""},setChangedWork:function(){this.work=m({},this.currentWork),this.renderedPhoto="".concat(f,"/").concat(this.work.photo),this.work.photo="",this.textLoadPhoto="Перетащите или нажмите, чтобы изменить фото работы",this.title="Редактирование работы"},changeFileWorkImg:function(t){var e=this;this.work.photo=t.target.files[0],Object(_.a)(this.work.photo).then((function(t){e.renderedPhoto=t})),this.textLoadPhoto="Перетащите или нажмите, чтобы изменить фото работы"},removeTag:function(t){this.tags.splice(t,1),this.work.techs=this.tags.join("")}},Object(k.b)("works",["addWork","changeWork"]),{handleWorkForm:function(){if(this.$v.$invalid)console.log("INVALID FORM");else{var t=new FormData;t.append("photo",this.work.photo),t.append("title",this.work.title),t.append("link",this.work.link),t.append("techs",this.work.techs),t.append("description",this.work.description),"new"===this.editMode?this.addNewWork(t):"edit"===this.editMode&&this.editWork(t,this.work.id),this.$emit("hideEditForm")}},addNewWork:function(t){var e=this;return l()(c.a.mark((function r(){return c.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.addWork(t);case 3:r.next=8;break;case 5:r.prev=5,r.t0=r.catch(0),alert("исправь потом меня, я ошибка из addNewWork: "+r.t0.message);case 8:return r.prev=8,r.finish(8);case 10:case"end":return r.stop()}}),r,null,[[0,5,8,10]])})))()},editWork:function(t,e){var r=this;return l()(c.a.mark((function o(){return c.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,r.changeWork({renewWorkData:t,changedWorkId:e});case 3:o.next=8;break;case 5:o.prev=5,o.t0=o.catch(0),alert("исправь потом меня, я ошибка из editWork: "+o.t0.message);case 8:return o.prev=8,o.finish(8);case 10:case"end":return o.stop()}}),o,null,[[0,5,8,10]])})))()}})},g=(r(428),r(49)),O=Object(g.a)(b,n,[],!1,null,null,null);O.options.__file="src/admin/components/app-edit-work.vue";var C=O.exports,j=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"work"},[r("div",{staticClass:"work__image"},[r("img",{staticClass:"work__picture",attrs:{src:t.baseUrl+"/"+t.workObject.photo}}),r("ul",{staticClass:"work__tags"},t._l(t.tags,(function(e){return r("li",{staticClass:"work__tag"},[t._v(t._s(e))])})),0)]),r("div",{staticClass:"work__info"},[r("div",{staticClass:"work__title"},[t._v(t._s(t.workObject.title))]),r("div",{staticClass:"work__text"},[t._v(t._s(t.workObject.description))]),r("a",{staticClass:"work__link"},[t._v(t._s(t.workObject.link))])]),r("div",{staticClass:"work__controls"},[r("div",{staticClass:"controls controls_with_text"},[r("span",{staticClass:"controls__text"},[t._v("Править                          ")]),r("button",{staticClass:"controls__btn controls__btn_blue_edit",on:{click:t.editWork}})]),r("div",{staticClass:"controls controls_with_text"},[r("span",{staticClass:"controls__text"},[t._v("Удалить                          ")]),r("button",{staticClass:"controls__btn controls__btn_red_remove",on:{click:t.removeWork}})])])])};function W(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function x(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?W(Object(r),!0).forEach((function(e){s()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):W(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}j._withStripped=!0;var y=u.a.defaults.baseURL,P={props:{workObject:Object},data:function(){return{changedWork:x({},this.workObject),baseUrl:y}},computed:{tags:function(){return this.workObject.techs.split(/[\s|,]+/)}},methods:x({},Object(k.b)("works",["deleteWork","setCurrentWork"]),{editWork:function(){this.setCurrentWork(this.changedWork.id),this.$emit("showEditForm","edit")},removeWork:function(){var t=this;return l()(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.deleteWork(t.workObject.id);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),alert("исправь потом меня, я ошибка из removeWork: "+e.t0.message);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))()}})},$=(r(429),Object(g.a)(P,j,[],!1,null,null,null));function L(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function E(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?L(Object(r),!0).forEach((function(e){s()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):L(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}$.options.__file="src/admin/components/app-work.vue";var F={components:{editWork:C,work:$.exports},data:function(){return{isVisibleEditForm:!1,editMode:""}},computed:E({},Object(k.d)("works",{allWorks:function(t){return t.works}}),{works:function(){return this.allWorks.sort((function(t,e){return e.id-t.id}))}}),created:function(){this.refreshAllWorks()},methods:E({},Object(k.b)("works",["refreshAllWorks","setCurrentWork"]),{showEditForm:function(t){this.isVisibleEditForm=!0,this.editMode=t,"new"===t&&this.setCurrentWork()},hideEditForm:function(){this.isVisibleEditForm=!1}})},D=(r(430),Object(g.a)(F,o,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"works__topgroup"},[e("h3",{staticClass:"works__title"},[this._v('Блок "Работы" ')])])}],!1,null,null,null));D.options.__file="src/admin/components/app-section-works.vue";e.default=D.exports}}]);